<app-header 
  [pageTitle]="'Carrello'" 
  [showBack]="true" 
  [backUrl]="'/dashboard'">
</app-header>

<ion-content>
  <section class="carrello-container">
    <h2>Il tuo Carrello</h2>

      <ng-container *ngIf="groupedCart as groups">
        <p *ngIf="!groups.length">Il carrello è vuoto.</p>


        <div *ngFor="let group of groups" class="supermarket-group">

          <h3 class="supermarket-title">
            {{ group.supermarketName }}
          </h3>

          <ion-list>
            <ion-item *ngFor="let item of group.items">
              <ion-label>{{ item.name }}</ion-label>
              <div class="flex">
                <div class="quantity-controls">
                  <span class="qty-btn" (click)="decreaseItem(item)">-</span>
                  <ion-badge color="primary">{{ item.quantity }}</ion-badge>
                  <span class="qty-btn" (click)="increaseItem(item)">+</span>
                </div>
                <ion-note slot="end" color="medium">{{ (item.price * item.quantity) | currency:'EUR':'symbol' }}</ion-note>
                <span class="remove-btn" (click)="removeProduct(item)">×</span>
              </div>
            </ion-item>
          </ion-list>

          <div class="group-total">
            Totale: {{ group.total | currency:'EUR':'symbol' }}
          </div>

          <ion-button expand="block" color="primary" class="checkout-btn" (click)="acquista(group.supermarketId)">
            Acquista
          </ion-button>

        </div>

      </ng-container>
      
  </section>
</ion-content> 